# rare_paths:
#   - unbiased: "paths/BToKshortMuMu_unbiased"
#   - filtered: "paths/BToKshortMuMu_Filtered"

# jpsi_paths: -1
#   # - unbiased: "paths/BToKshortJpsi_unbiased"
#   # - filtered: "paths/BToKshortJpsi_Filtered"

# psi2s_paths: -1
#   # - unbiased: "paths/BToKshortPsi2S_unbiased"
#   # - filtered: "paths/BToKshortPsi2S_Filtered"

process: BToKshortMuMu
verbose: false
NBINS: 15
BINS:
  - [0.0, 0.98]
  - [1.1, 2.]
  - [2., 3.]
  - [3., 4.]
  - [4., 5.]
  - [5., 6.]
  - [6., 7.]
  - [7., 8.]
  - [11., 11.8]
  - [11.8, 12.50]
  - [14.8225, 16.]
  - [16., 17.]
  - [17., 18.]
  - [18., 19.246]
  - [19.246, 23.]

definitions:
  - name: "lead_pt"
    expression:  "TMath::Max(genMu1_pt, genMu2_pt)"
  - name: "sublead_pt"
    expression:  "TMath::Min(genMu1_pt, genMu2_pt)"
  - name: "lead_eta"
    expression:  "TMath::Max(genMu1_eta, genMu2_eta)"
  - name: "sublead_eta"
    expression:  "TMath::Min(genMu1_eta, genMu2_eta)"
  - name: "IPsig1"
    expression: "if(recoMu1_dxyErr!=0.){return abs(recoMu1_dxy) / recoMu1_dxyErr;} else {return (float)-99.;}"
  - name: "IPsig2"
    expression: "if(recoMu2_dxyErr!=0.){return abs(recoMu2_dxy) / recoMu2_dxyErr;} else {return (float)-99.;}"

samples:
  - name: unbiased
    tree: Events
    paths: /eos/cms/store/cmst3/user/alexandg/Thesis/RKshort_ntuples/mc_noCuts/BToKshortMuMu_unbiased/BToKshortMuMu_unbiased_Chunk*.root_BToKshortMuMu_unbiased_Chunk*_*.root
    cuts:
      - name: filter_cuts
        expression: "(genMu1_pt > 6 && TMath::Abs(genMu1_eta) < 2.5) || (genMu2_pt > 6 && TMath::Abs(genMu2_eta) < 2.5)"

  - name: Filtered
    tree: Events
    paths: /eos/cms/store/cmst3/user/alexandg/Thesis/RKshort_ntuples/mc_noCuts/BToKshortMuMu_Filtered/BToKshortMuMu_Filtered_Chunk*.root_BToKshortMuMu_Filtered_Chunk*_*.root
    cuts:
      - name: filter_cuts
        expression: "(genMu1_pt > 6 && TMath::Abs(genMu1_eta) < 2.5) || (genMu2_pt > 6 && TMath::Abs(genMu2_eta) < 2.5)"
        # hists:
        #   - name: lead_pt
        #     value: "lead_pt"
        #     nbins: 100
        #     min: 0
        #     max: 0
          # - name: sublead_pt
          #   value: "sublead_pt"
          #   nbins: 100
          #   min: 0
          #   max: 0      
          # - name: lead_eta
          #   value: "lead_eta"
          #   nbins: 100
          #   min: 0
          #   max: 0      
          # - name: sublead_eta
          #   value: "sublead_eta"
          #   nbins: 100
          #   min: 0
          #   max: 0      

      - name: eta_cuts
        expression: "(genMu1_pt > 6 && abs(genMu1_eta) < 1.5) || (genMu2_pt > 6 && abs(genMu2_eta) < 1.5)"

      - name: pt_cuts
        expression: "(genMu1_pt > 9 && abs(genMu1_eta) < 1.5) || (genMu2_pt > 9 && abs(genMu2_eta) < 1.5)"

      - name: reco_cuts
        expression: "(genMu1_pt > 9 && abs(genMu1_eta) < 1.5 && recoMu1_DR < 0.03) || (genMu2_pt > 9 && abs(genMu2_eta) < 1.5 && recoMu2_DR < 0.03)"

      - name: cuts_cuts
        expression: "(genMu1_pt > 9 && abs(genMu1_eta) < 1.5 && recoMu1_DR < 0.03 && recoMu1_pt > 9 && abs(recoMu1_eta) < 1.5 && IPsig1 > 6) || (genMu2_pt > 9 && abs(genMu2_eta) < 1.5 && recoMu2_DR < 0.03 && recoMu2_pt > 9 && abs(recoMu2_eta) < 1.5 && IPsig2 > 6)"

      - name: HLT_cuts
        expression: "((genMu1_pt > 9 && abs(genMu1_eta) < 1.5 && recoMu1_DR < 0.03 && recoMu1_pt > 9 && abs(recoMu1_eta) < 1.5 && IPsig1 > 6 && recoMu1_isTrg > 0) || (genMu2_pt > 9 && abs(genMu2_eta) < 1.5 && recoMu2_DR < 0.03 && recoMu2_pt > 9 && abs(recoMu2_eta) < 1.5 && IPsig2 > 6 && recoMu2_isTrg > 0)) && HLT_Mu9_IP6 > 0"

      - name: acc_reco_cuts
        expression: "((genMu1_pt > 9 && abs(genMu1_eta) < 1.5 && recoMu1_DR < 0.03 && recoMu1_pt > 9 && abs(recoMu1_eta) < 1.5 && IPsig1 > 6 && genMu2_pt > 2 && abs(genMu2_eta) < 2.4 && recoMu1_isTrg > 0) || (genMu2_pt > 9 && abs(genMu2_eta) < 1.5 && recoMu2_DR < 0.03 && recoMu2_pt > 9 && abs(recoMu2_eta) < 1.5 && IPsig2 > 6 && genMu1_pt > 2 && abs(genMu1_eta) < 2.4 && recoMu2_isTrg > 0)) && HLT_Mu9_IP6 > 0 && genKshort_pt > 1 && abs(genKshort_eta) < 2.4"

      - name: eff_recon_cuts
        expression: "((genMu1_pt>9 && abs(genMu1_eta)<1.5 && recoMu1_pt>9 && abs(recoMu1_eta)<1.5 && IPsig1>6 && recoMu1_isTrg>0 && genMu2_pt>2 && abs(genMu2_eta)<2.4) || (genMu2_pt>9 && abs(genMu2_eta)<1.5 && recoMu2_pt>9 && abs(recoMu2_eta)<1.5 && IPsig2>6 && recoMu2_isTrg>0 && genMu1_pt>2 && abs(genMu1_eta)<2.4)) && HLT_Mu9_IP6>0 && genKshort_pt>1 && abs(genKshort_eta)<2.4 && recoKshort_DR<0.03 && recoMu1_mediumId>0 && recoMu2_mediumId>0 && recoMu1_DR<0.03 && recoMu2_DR<0.03"

      - name: pres_cuts
        expression: "((genMu1_pt>9 && abs(genMu1_eta)<1.5 && recoMu1_pt>9 && abs(recoMu1_eta)<1.5 && IPsig1>6 && recoMu1_isTrg>0 && genMu2_pt>2 && abs(genMu2_eta)<2.4) || (genMu2_pt>9 && abs(genMu2_eta)<1.5 && recoMu2_pt>9 && abs(recoMu2_eta)<1.5 && IPsig2>6 && recoMu2_isTrg>0 && genMu1_pt>2 && abs(genMu1_eta)<2.4)) && HLT_Mu9_IP6>0 && genKshort_pt>1 && abs(genKshort_eta)<2.4 && recoKshort_DR<0.03 && recoMu1_mediumId>0 && recoMu2_mediumId>0 && recoMu1_DR<0.03 && recoMu2_DR<0.03 && recoB_fit_mass > 5. && recoB_fit_mass < 5.6 && recoB_l_xy_unc != 0 && recoB_svprob > 0.00001 && recoB_fit_cos2D > 0.9 && (!TMath::IsNaN(recoB_svprob)) && abs(recoB_l_xy) / recoB_l_xy_unc > 1.0"

# plots:
#   unbiased:
#     - name: unbiased_mass_acceptance
#       yaxis_title: "Mass Acceptance"
#       title: "Unbiased Mass Acceptance"
#       filename: "unbiased_mass_acceptance.png"
#       divide_by_binwidth: false
#       zero_suppression: true

#     - name: total_fiter_acceptance
#       yaxis_title: "Mass Acceptance"
#       title: "Total Filter Acceptance"
#       filename: "total_filter_acceptance.png"
#       divide_by_binwidth: false
#       zero_suppression: true

#   biased:
#     - name: biased_mass_acceptance
#       yaxis_title: "Mass Acceptance"
#       title: "Biased Mass Acceptance"
#       filename: "biased_mass_acceptance.png"
#       divide_by_binwidth: false
#       zero_suppression: true

#     - name: biased_filter_acceptance
#       yaxis_title: "Filter Acceptance"
#       title: "Biased Filter Acceptance"
#       filename: "biased_filter_acceptance.png"
#       divide_by_binwidth: false
#       zero_suppression: true

#     - name: eta_acceptance
#       yaxis_title: "Eta Acceptance"
#       title: "Eta Acceptance"
#       filename: "eta_acceptance.png"
#       divide_by_binwidth: false
#       zero_suppression: true
    
#     - name: pt_acceptance
#       yaxis_title: "p_{T} Acceptance"
#       title: "p_{T} Acceptance"
#       filename: "pt_acceptance.png"
#       divide_by_binwidth: false
#       zero_suppression: true
    
#     - name: reco_efficiency
#       yaxis_title: "Reconstruction Efficiency"
#       title: "Reconstruction Efficiency"
#       filename: "reco_efficiency.png"
#       divide_by_binwidth: false
#       zero_suppression: true

#     - name: cuts_efficiency
#       yaxis_title: "Cuts Efficiency"
#       title: "Cuts Efficiency"
#       filename: "cuts_efficiency.png"
#       divide_by_binwidth: false
#       zero_suppression: true

#     - name: hlt_efficiency
#       yaxis_title: "HLT Efficiency"
#       title: "HLT Efficiency"
#       filename: "hlt_efficiency.png"
#       divide_by_binwidth: false
#       zero_suppression: true
    
#     - name: other_acceptance
#       yaxis_title: "Other Muon and Kaon Acceptance"
#       title: "Other Muon and Kaon Acceptance"
#       filename: "other_acceptance.png"
#       divide_by_binwidth: false
#       zero_suppression: true
    
#     - name: other_efficiency
#       yaxis_title: "Other Muon and Kaon Efficiency"
#       title: "Other Muon and Kaon Efficiency"
#       filename: "other_efficiency.png"
#       divide_by_binwidth: false
#       zero_suppression: true
    
#     - name: preselection_efficiency
#       yaxis_title: "Preselection Efficiency"
#       title: "Preselection Efficiency"
#       filename: "preselection_efficiency.png"
#       divide_by_binwidth: false
#       zero_suppression: true
    
#     - name: antiD0_efficiency
#       yaxis_title: "AntiD0 Efficiency"
#       title: "AntiD0 Efficiency"
#       filename: "antiD0_efficiency.png"
#       divide_by_binwidth: false
#       zero_suppression: true
    
#     - name: jpsi_veto_efficiency  
#       yaxis_title: "Jpsi Veto Efficiency"
#       title: "Jpsi Veto Efficiency"
#       filename: "jpsi_veto_efficiency.png"
#       divide_by_binwidth: false
#       zero_suppression: true
    
#     - name: acceptance_efficiency
#       yaxis_title: "Total #alpha #times #epsilon"
#       title: "Total Acceptance #times Efficiency"
#       filename: "acceptance_efficiency.png"
#       divide_by_binwidth: false
#       zero_suppression: true
